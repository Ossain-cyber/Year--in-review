<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Year in Review ‚Äî Responsive Poster (1080√ó1080)</title>

<style>
  :root{
    --bg:#0b1220; --card:#0f1724; --text:#e8eef8; --muted:rgba(232,238,248,0.6);
    --accent1:#7c3aed; --accent2:#06b6d4;
    --ui-radius:12px;
  }
  @media (prefers-color-scheme: light) {
    :root{
      --bg:#f5f7fb; --card:#fff; --text:#071127; --muted:rgba(7,17,39,0.55);
      --accent1:#5b21b6; --accent2:#0891b2;
    }
  }

  html,body{height:100%;margin:0;background:linear-gradient(180deg, rgba(0,0,0,0.03), rgba(255,255,255,0.02)),var(--bg); color:var(--text); font-family:Inter, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial; -webkit-font-smoothing:antialiased}
  .wrap{max-width:1100px;margin:18px auto;padding:16px}
  header{display:flex;align-items:center;justify-content:space-between;gap:12px}
  .brand{display:flex;align-items:center;gap:12px}
  .logo{width:48px;height:48px;border-radius:10px;background:linear-gradient(135deg,var(--accent1),var(--accent2));display:flex;align-items:center;justify-content:center;color:white;font-weight:800}
  h1{margin:0;font-size:1.15rem}
  .lead{margin:4px 0 0 0;color:var(--muted);font-size:.92rem}

  /* layout */
  .grid{display:grid;grid-template-columns:1fr 420px;gap:18px;margin-top:18px}
  @media(max-width:980px){ .grid{grid-template-columns:1fr} }

  .card{background:var(--card);border-radius:var(--ui-radius);padding:14px;box-shadow:0 10px 30px rgba(2,6,23,0.45); transition:transform .18s ease}
  .card:active{transform:translateY(2px)}

  label{display:block;color:var(--muted);font-size:.9rem;margin-bottom:6px}
  input[type="text"], input[type="number"], textarea{
    width:100%;padding:10px;border-radius:8px;border:1px solid rgba(255,255,255,0.03);background:transparent;color:var(--text);font-size:.96rem;
  }
  textarea{min-height:80px;resize:vertical}

  .row{display:flex;gap:8px;align-items:center}
  .btn{background:linear-gradient(90deg,var(--accent1),var(--accent2));color:white;padding:10px 14px;border-radius:10px;border:none;cursor:pointer;font-weight:700}
  .btn.ghost{background:transparent;border:1px solid rgba(255,255,255,0.06);color:var(--text);font-weight:600}

  /* poster preview responsive container */
  .poster-outer{display:flex;flex-direction:column;align-items:center;gap:12px}
  .poster-preview{
    width:360px; height:360px; border-radius:14px; overflow:hidden; display:block; box-shadow:0 22px 50px rgba(2,6,23,0.55);
    transition:transform .35s cubic-bezier(.2,.9,.2,1);
    will-change:transform;
    background:rgba(255,255,255,0.02); /* show edge */
  }
  .poster-preview:active{transform:scale(0.995)}
  @media(max-width:420px){ .poster-preview { width:86vw; height:86vw } }

  .actions{display:flex;gap:8px;flex-wrap:wrap;justify-content:center;margin-top:6px}
  .actions .share{background:#111;padding:8px 10px;border-radius:8px;color:white;border:none;cursor:pointer}

  .small{font-size:.88rem;color:var(--muted)}

  /* confetti canvas covers whole screen */
  #confetti{position:fixed;left:0;top:0;width:100%;height:100%;pointer-events:none;z-index:9000}

  /* footer */
  footer{margin-top:18px;color:var(--muted);text-align:center;font-size:.88rem}

  /* accessibility focus states */
  button:focus, input:focus, textarea:focus { outline:3px solid rgba(124,58,237,0.12); outline-offset:2px; }
</style>
</head>
<body>
  <canvas id="confetti"></canvas>

  <div class="wrap">
    <header>
      <div class="brand">
        <div class="logo">Ao</div>
        <div>
          <h1>Year in Review ‚Äî Poster (1080√ó1080)</h1>
          <div class="lead">Responsive preview ‚Ä¢ polished poster ‚Ä¢ share-ready</div>
        </div>
      </div>

      <div style="display:flex;gap:8px;align-items:center">
        <div class="small">Theme</div>
        <button id="themeToggle" class="btn ghost" aria-label="Toggle theme">Toggle</button>
      </div>
    </header>

    <div class="grid" role="main">
      <!-- left: inputs -->
      <div class="card" aria-labelledby="formTitle">
        <h2 id="formTitle" style="margin:0 0 10px 0">Tell us about your 2025</h2>

        <label for="movies">Top 5 Movies (comma separated)</label>
        <input id="movies" type="text" placeholder="Dune, Everything Everywhere, ...">

        <label style="margin-top:10px" for="songs">Top songs (comma separated)</label>
        <input id="songs" type="text" placeholder="Song A, Song B">

        <label style="margin-top:10px" for="books">Books read</label>
        <input id="books" type="number" min="0" placeholder="Number of books">

        <label style="margin-top:10px" for="highlight">Personal highlight</label>
        <textarea id="highlight" placeholder="e.g., got a promotion, traveled to Japan"></textarea>

        <div style="margin-top:12px" class="row">
          <button id="generate" class="btn">üéâ Generate Poster</button>
          <button id="save" class="btn ghost">üíæ Save</button>
          <button id="clear" class="btn ghost">üóë Clear</button>
        </div>

        <p class="small" style="margin-top:10px">Tip: preview updates live as you type. Press <strong>Ctrl/Cmd+G</strong> to generate.</p>
      </div>

      <!-- right: preview & actions -->
      <aside style="display:flex;flex-direction:column;align-items:center;gap:12px">
        <div class="card poster-outer" role="region" aria-label="Poster preview">
          <div style="width:100%;display:flex;justify-content:space-between;align-items:center">
            <div>
              <div class="small">Preview</div>
              <strong>Poster (square)</strong>
            </div>
            <div class="small" id="status">Nothing yet</div>
          </div>

          <!-- visible preview: scaled down canvas -->
          <div class="poster-preview" aria-hidden="false" title="Poster preview">
            <canvas id="previewCanvas" width="1080" height="1080" style="width:100%;height:100%;display:block"></canvas>
          </div>

          <div class="actions" role="group" aria-label="Actions">
            <button id="download" class="btn" disabled>‚¨áÔ∏è Download PNG</button>
            <button id="openImage" class="btn ghost" disabled>Open image</button>
            <button id="share" class="btn ghost" disabled>üîó Share</button>
          </div>

          <div class="small">Poster includes a tiny credit: <em>Made with ‚ù§Ô∏è by Hussain</em></div>
        </div>

        <div class="card" style="width:100%">
          <div style="display:flex;justify-content:space-between;align-items:center">
            <div>
              <div class="small">Live summary</div>
              <strong id="liveTitle">‚Äî</strong>
            </div>
            <div style="text-align:right">
              <div class="small">Books</div>
              <div id="liveBooks" style="font-weight:800;font-size:1.2rem">0</div>
            </div>
          </div>
          <div style="margin-top:12px;display:flex;gap:12px">
            <div style="flex:1">
              <div class="small">Movies</div>
              <div id="liveMovies" style="font-weight:700">‚Äî</div>
            </div>
            <div style="flex:1">
              <div class="small">Songs</div>
              <div id="liveSongs" style="font-weight:700">‚Äî</div>
            </div>
          </div>
        </div>

      </aside>
    </div>

    <footer>Prototype ‚Äî made with ‚ù§Ô∏è by Hussain</footer>
  </div>

<script>
/* ---------- State & DOM ---------- */
const $ = id => document.getElementById(id);
const confettiCanvas = $('confetti');
const confettiCtx = confettiCanvas.getContext('2d');
confettiCanvas.width = innerWidth; confettiCanvas.height = innerHeight;
window.addEventListener('resize', ()=>{ confettiCanvas.width = innerWidth; confettiCanvas.height = innerHeight; });

const moviesInput = $('movies'), songsInput = $('songs'), booksInput = $('books'), highlightInput = $('highlight');
const previewCanvas = $('previewCanvas'), previewCtx = previewCanvas.getContext('2d');
const generateBtn = $('generate'), downloadBtn = $('download'), shareBtn = $('share'), openBtn = $('openImage');
const saveBtn = $('save'), clearBtn = $('clear'), themeToggle = $('themeToggle');

const liveMovies = $('liveMovies'), liveSongs = $('liveSongs'), liveBooks = $('liveBooks'), liveTitle = $('liveTitle'), status = $('status');

let state = { movies:[], songs:[], books:0, highlight:'' };

/* ---------- Utility: draw poster (1080x1080) ---------- */
function drawPoster(ctx, data, theme='auto'){
  // data: {movies, songs, books, highlight}
  const W = 1080, H = 1080;
  ctx.clearRect(0,0,W,H);

  // theme auto selection
  const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
  const t = theme === 'auto' ? (document.documentElement.getAttribute('data-theme') || (prefersDark ? 'dark' : 'light')) : theme;

  const bgStart = t==='dark' ? '#071226' : '#ffffff';
  const bgEnd   = t==='dark' ? '#0b1728' : '#f7fbff';
  const g = ctx.createLinearGradient(0,0,W,H);
  g.addColorStop(0, bgStart);
  g.addColorStop(1, bgEnd);
  ctx.fillStyle = g;
  ctx.fillRect(0,0,W,H);

  // soft center glow
  const glow = ctx.createRadialGradient(W*0.5,H*0.32,10,W*0.5,H*0.32,W*0.9);
  glow.addColorStop(0, 'rgba(124,58,237,0.14)');
  glow.addColorStop(1, 'rgba(0,0,0,0)');
  ctx.fillStyle = glow; ctx.fillRect(0,0,W,H);

  // Title
  ctx.textAlign = 'center';
  ctx.fillStyle = t==='dark' ? '#ffffff' : '#071127';
  ctx.font = 'bold 56px Inter, sans-serif';
  ctx.fillText('Your 2025 in Review', W/2, 120);

  // subtitle
  ctx.font = '400 18px Inter, sans-serif';
  ctx.fillStyle = t==='dark' ? 'rgba(255,255,255,0.85)' : 'rgba(6,18,39,0.7)';
  ctx.fillText('A clean poster ‚Äî ready to share', W/2, 150);

  // layout stats
  function statBlock(x,y,icon,label,value){
    // icon circle
    ctx.beginPath();
    ctx.fillStyle = t==='dark' ? 'rgba(255,255,255,0.06)' : 'rgba(0,0,0,0.04)';
    roundRect(ctx, x-28, y-40, 64, 64, 14);
    ctx.fill();

    // emoji (use text)
    ctx.font = '42px serif';
    ctx.fillText(icon, x-6, y+8);

    // value
    ctx.textAlign = 'left';
    ctx.font = '700 46px Inter, sans-serif';
    ctx.fillStyle = t==='dark' ? '#fff' : '#071127';
    ctx.fillText(value, x+44, y);

    // small label
    ctx.font = '500 16px Inter, sans-serif';
    ctx.fillStyle = t==='dark' ? 'rgba(255,255,255,0.85)' : '#475569';
    ctx.fillText(label, x+44, y+34);
  }

  const leftX = 160, rightX = W - 420;
  let y = 240;
  statBlock(leftX, y, 'üé¨', 'Top movies', data.movies.length ? data.movies.slice(0,3).join(', ') : '‚Äî');
  statBlock(rightX, y, 'üéµ', 'Top songs', data.songs.length ? data.songs.slice(0,3).join(', ') : '‚Äî');

  y += 170;
  statBlock(leftX, y, 'üìö', 'Books read', String(data.books || 0));
  statBlock(rightX, y, '‚≠ê', 'Highlight', data.highlight || '‚Äî');

  // footer small credit
  ctx.textAlign = 'center';
  ctx.font = '400 14px Inter, sans-serif';
  ctx.fillStyle = t==='dark' ? 'rgba(255,255,255,0.65)' : 'rgba(6,18,39,0.5)';
  ctx.fillText('Made with ‚ù§Ô∏è by Hussain ‚Äî 2025', W/2, H - 40);

  // subtle decorative dots
  for(let i=0;i<10;i++){
    const rx = Math.random()*W;
    const ry = Math.random()*(H*0.75)+80;
    const r = Math.random()*6 + 2;
    ctx.beginPath();
    ctx.fillStyle = t==='dark' ? `rgba(124,58,237,${Math.random()*0.08})` : `rgba(6,182,212,${Math.random()*0.08})`;
    ctx.arc(rx,ry,r,0,Math.PI*2);
    ctx.fill();
  }
}

// helper roundRect
function roundRect(ctx,x,y,w,h,r){
  if(r===undefined) r=6;
  ctx.beginPath();
  ctx.moveTo(x+r,y);
  ctx.arcTo(x+w,y,x+w,y+h,r);
  ctx.arcTo(x+w,y+h,x,y+h,r);
  ctx.arcTo(x,y+h,x,y,r);
  ctx.arcTo(x,y,x+w,y,r);
  ctx.closePath();
}

/* ---------- Preview rendering (scaled) ---------- */
function renderPreview(){
  const data = {
    movies: parseCSV(moviesInput.value),
    songs: parseCSV(songsInput.value),
    books: Number(booksInput.value) || 0,
    highlight: (highlightInput.value || '').trim()
  };
  // draw to 1080 canvas (preview canvas is full-resolution but CSS-scaled)
  drawPoster(previewCtx, data, 'auto');

  // update live text
  liveTitle.textContent = data.movies.length ? (data.movies[0] + (data.movies.length>1 ? ' & more' : '')) : '‚Äî';
  liveMovies.textContent = data.movies.length ? data.movies.slice(0,3).join(' ¬∑ ') : '‚Äî';
  liveSongs.textContent = data.songs.length ? data.songs.slice(0,3).join(' ¬∑ ') : '‚Äî';
  liveBooks.textContent = data.books || 0;
  status.textContent = (data.movies.length||data.songs.length||data.books||data.highlight) ? 'Ready' : 'Nothing yet';

  // enable download/share if there is any content
  const has = data.movies.length || data.songs.length || data.books || data.highlight;
  downloadBtn.disabled = !has;
  shareBtn.disabled = !has;
  openBtn.disabled = !has;
}

/* ---------- Confetti (light, optimized) ---------- */
let confetti = [];
function spawnConfetti(x=innerWidth/2,y=innerHeight/3,count=80){
  const colors = ['#ff5f6d','#ffc371','#7bffb2','#7bd3ff','#c79bff','#ffd166'];
  for(let i=0;i<count;i++){
    confetti.push({
      x,y,
      vx:(Math.random()-0.5)*10,
      vy: (Math.random()*-6)-2,
      r: Math.random()*8+4,
      color: colors[Math.floor(Math.random()*colors.length)],
      rot: Math.random()*360,
      vr:(Math.random()-0.5)*8,
      life: Math.random()*90+40
    });
  }
}
function confettiLoop(){
  confettiCtx.clearRect(0,0,confettiCanvas.width,confettiCanvas.height);
  for(let i=confetti.length-1;i>=0;i--){
    const p = confetti[i];
    p.vy += 0.34;
    p.x += p.vx; p.y += p.vy; p.rot += p.vr; p.life--;
    confettiCtx.save();
    confettiCtx.translate(p.x,p.y);
    confettiCtx.rotate(p.rot*Math.PI/180);
    confettiCtx.fillStyle = p.color;
    confettiCtx.fillRect(-p.r/2, -p.r/2, p.r, p.r*0.6);
    confettiCtx.restore();
    if(p.y > confettiCanvas.height + 60 || p.life<=0) confetti.splice(i,1);
  }
  requestAnimationFrame(confettiLoop);
}
confettiLoop();

/* ---------- Download & share ---------- */
function downloadImage(){
  // ensures preview canvas has latest content
  renderPreview();
  // download as PNG (1080)
  previewCanvas.toBlob(function(blob){
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a'); a.href = url; a.download = 'year-in-review-2025.png';
    document.body.appendChild(a); a.click(); a.remove(); URL.revokeObjectURL(url);
  }, 'image/png', 0.95);
}

async function shareImage(){
  renderPreview();
  // try Web Share API with files
  previewCanvas.toBlob(async (blob)=>{
    try{
      const file = new File([blob], 'year-in-review-2025.png', {type:'image/png'});
      if(navigator.canShare && navigator.canShare({files:[file]})){
        await navigator.share({ files:[file], title:'My 2025 Year in Review', text:'My 2025 Year in Review ‚Äî created with August One' });
        return;
      }
    }catch(e){
      console.warn('share API error', e);
    }
    // fallback: open image in new tab
    const url = URL.createObjectURL(blob);
    window.open(url,'_blank');
    try{ await navigator.clipboard.writeText('My 2025 Year in Review ‚Äî image opened in new tab.'); alert('Image opened in new tab. Share manually.'); }
    catch(e){ alert('Image opened in new tab.'); }
  }, 'image/png');
}

/* ---------- Utility parse CSV ---------- */
function parseCSV(s){ return (s||'').split(',').map(x=>x.trim()).filter(Boolean); }

/* ---------- Save / Clear ---------- */
const SAVE_KEY = 'ao_poster_v2';
$('save').addEventListener('click', ()=>{
  const s = { movies: moviesInput.value, songs: songsInput.value, books: booksInput.value, highlight: highlightInput.value };
  localStorage.setItem(SAVE_KEY, JSON.stringify(s));
  alert('Saved locally');
});
$('clear').addEventListener('click', ()=>{
  if(!confirm('Clear inputs and preview?')) return;
  moviesInput.value=''; songsInput.value=''; booksInput.value=''; highlightInput.value='';
  renderPreview();
});

/* ---------- Theme toggle ---------- */
themeToggle.addEventListener('click', ()=>{
  const cur = document.documentElement.getAttribute('data-theme');
  const next = cur === 'dark' ? 'light' : 'dark';
  document.documentElement.setAttribute('data-theme', next);
  localStorage.setItem('ao_theme', next);
  renderPreview();
});
(function loadTheme(){
  const saved = localStorage.getItem('ao_theme');
  if(saved) document.documentElement.setAttribute('data-theme', saved);
})();

/* ---------- Wire events ---------- */
moviesInput.addEventListener('input', debounce(renderPreview,120));
songsInput.addEventListener('input', debounce(renderPreview,120));
booksInput.addEventListener('input', debounce(renderPreview,120));
highlightInput.addEventListener('input', debounce(renderPreview,120));

generate.addEventListener('click', ()=>{
  renderPreview();
  // animate preview
  const p = document.querySelector('.poster-preview');
  p.style.transform = 'scale(1.03) translateY(-8px)';
  setTimeout(()=> p.style.transform = '', 450);

  // confetti
  spawnConfetti(window.innerWidth/2, window.innerHeight*0.25, 140);

  // enable actions
  downloadBtn.disabled = false; shareBtn.disabled = false; openBtn.disabled = false;
  // optional: flash status
  status.textContent = 'Generated';
  setTimeout(()=> status.textContent = (moviesInput.value||songsInput.value||booksInput.value||highlightInput.value) ? 'Ready' : 'Nothing yet', 1200);
});

downloadBtn.addEventListener('click', downloadImage);
openImage.addEventListener('click', ()=>{
  previewCanvas.toBlob((blob)=>{
    const url = URL.createObjectURL(blob);
    window.open(url,'_blank');
    setTimeout(()=> URL.revokeObjectURL(url), 30000);
  }, 'image/png');
});
shareBtn.addEventListener('click', shareImage);

/* keyboard shortcut */
window.addEventListener('keydown', (e)=> { if((e.ctrlKey||e.metaKey) && e.key.toLowerCase()==='g'){ e.preventDefault(); generate.click(); } });

/* ---------- On load: load saved data & render ---------- */
(function init(){
  const raw = localStorage.getItem(SAVE_KEY);
  if(raw){
    try{
      const s = JSON.parse(raw);
      moviesInput.value = s.movies||'';
      songsInput.value = s.songs||'';
      booksInput.value = s.books||'';
      highlightInput.value = s.highlight||'';
    }catch(e){}
  }
  // ensure canvas DPI correct (we always draw at 1080, but css scales)
  const dpr = window.devicePixelRatio || 1;
  // previewCanvas size set to 1080x1080 in HTML; CSS scales it down. We'll ensure pixel ratio is preserved by drawing at 1080 directly.
  previewCanvas.width = 1080; previewCanvas.height = 1080;
  renderPreview();
})();

/* ---------- helpers ---------- */
function debounce(fn, wait=150){ let t; return (...a)=>{ clearTimeout(t); t=setTimeout(()=>fn(...a), wait); } }
</script>
</body>
</html>